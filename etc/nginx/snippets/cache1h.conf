# Cache upstream responses for 1 hour (reference example for moderately dynamic data).
proxy_cache       cache;
proxy_cache_valid 200 1h;
proxy_cache_key   "$scheme$host$request_uri"; # Include host so cache is safe across multiple vhosts
proxy_cache_lock  on;
proxy_cache_methods GET HEAD;           # Only cache safe, idempotent methods

# Prevent upstream Set-Cookie / cache-control headers from bypassing or poisoning the cache.
proxy_hide_header    Set-Cookie;
proxy_ignore_headers Set-Cookie Cache-Control Expires;

include /etc/nginx/snippets/security-headers.conf;
add_header X-Cache-Status $upstream_cache_status always;
